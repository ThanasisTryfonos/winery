# Eclipse Winery™ Angular UI

## Prerequisites
1. Install [git](https://git-scm.com)
2. Install and setup [Node.js](https://nodejs.org/en/) and [NPM](https://www.npmjs.com) for [Angular4](https://angular.io/docs/ts/latest/quickstart.html)

### Backend
The frontend assumes that the backend server is running on
- the same host,
- the same protocol,
- the same port and
- at `/winery`.
- The only exception is when the UI is running on port `3000`, the port is assumed to be `8080`.
Therefore, an example request to the backend, if it runs locally, looks like this: <http://localhost:8080/winery/servicetemplates>.

Equal assumptions are made for the workflow modeler:
- the same host,
- the same protocol,
- the same port and
- at `/winery-workflowmodeler`.
- With the exception that in development mode, the workflow modeler is assumed to be running on port `9527`. Therefore, 
an example request to the backend, if it runs locally, looks like this: <http://localhost:9527/winery-workflowmodeler/?repositoryURL=http:%2F%2Fdev.winery.opentosca.org%2Fwinery%2F&namespace=http:%2F%2Fwww.example.org%2Fservicetemplates&id=PlanDemonstration&plan=Test>

## Setup Local Development Server
1. `npm install`
2. `npm start` 
    - be sure that no other application is listening on port 3000
    - if you need to switch to another port adapt config/webpack.dev.js
3. Now the server is running on `http://localhost:3000`
    
## Setup Debugging Environment
1. Make sure to use IntelliJ/Webstorm Ultimate in the version 2017.1 or higher
1. Install the [JetBrains Chrome Plugin](https://chrome.google.com/webstore/detail/jetbrains-ide-support/hmhgeddbohgjknpmjagkdomcpobmllji?hl=en)
1. Create a new run configuration in IntelliJ
   1. `Run –> Edit configurations… –> Add –> JavaScript Debug`
   1. Name the configuration `Debug Angular-Ui`
   1. Add `http://localhost:3000` as URL
   1. Choose Browser `Chrome` instead of `default`
   1. Press OK
1. Use the debug button to run the debugger.
1. Now breakpoints can be set anywhere in the code. IntelliJ/Webstorm even shows if the breakpoint is reachable or not by
   showing a hook or a cross in the breakpoint.

**IMPORTANT: always make sure to run** `npm start` **first! Otherwise the app is not running and therefore not loading
   when running the debugger.**

## TSLint
1. Go to `File -> Settings -> Language and Frameworks -> TypeScript -> TSLint`
2. Set `Enabled` to true
3. Press `OK` 

Usually IntelliJ finds the `tslint.json` automatically, otherwise configure it in the same window yourself.  

### Automatically fix issues
Use the `[Alt] + [Enter]` shortcut to quickly fix TSLint errors by selecting `TSLint: Fix current ...`

#### Fix all issues at once
1. Install TSLint global
2. Go to this directory and start the command line
3. run `tslint --fix ./src/**/*.ts`

Most errors will be fix automatically. More complex ones need to be resolved manually still! 


## Production Build
After step 3 at setting up local development server do
`npm run build` (please note that production build is only triggered if linting returns with no errors!)

### API Documentation
The production build also adds a automatically generated **documentation** which can be found at `/dist/doc/index.html`.
It is generated by the comments describing a class/method/member. Examples can be found in the `WineryTableComponent` 
or the `WineryModalComponent`.
    
## Just do Linting
Use the tslint-cli for this:
`tslint ./src/**/*.ts`


## Generate winery-ui.war
Execute `mvn package`.

## License

Copyright (c) 2017 University of Stuttgart.

All rights reserved. This program and the accompanying materials
are made available under the terms of the [Eclipse Public License v1.0]
and the [Apache License v2.0] which both accompany this distribution,
and are available at http://www.eclipse.org/legal/epl-v10.html
and http://www.apache.org/licenses/LICENSE-2.0
